<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:o="http://omnifaces.org/ui" xmlns:p="http://primefaces.org/ui">
<h:head>
</h:head>
	<h:body>
		<div class="wizardCon">
			<h:form enctype="multipart/form-data">
				<p:growl id="growl" sticky="true" showDetail="true" />
				<p:wizard flowListener="#{newPostBackBean.onFlowProcess}" style="direction:rtl" nextLabel="#{msg['next']}" backLabel="#{msg['back']}"
				id="addPostWizrd">
					<p:tab id="info" title="#{msg['addPost']}">
						<p:panel header="#{msg['info']}">
							<p:messages autoUpdate="true"/>
							<h:panelGrid columns="1" columnClasses="label, value">
								<h:outputText value="#{msg['itemName']}" />
								<p:inputText value="#{newPostBackBean.item.name}" required="true" id="itemName"
									label="#{msg['itemName']}" requiredMessage="#{msg['required']}">
									<p:ajax event="blur" process="@this" update="@this"/>
									
									<f:validateLength minimum="2" maximum="255"/>
								</p:inputText>
								
								<h:outputText value="#{msg['price']}" />
								<p:inputText value="#{newPostBackBean.item.price}" required="true" id="priceInput" converterMessage="#{msg['numberRequired']}"
									requiredMessage="#{msg['required']}" label="#{msg['price']}" validatorMessage="#{msg['numberRequired']}">
									
									<p:ajax event="blur" process="@this" update="@this"/>
									<f:validateDoubleRange minimum="1" for="priceInput" />
									<f:validateLength minimum="1" maximum="19"/>
								</p:inputText>
								
								<h:outputText value="#{msg['desc']}" id="itemDesc"/>
								<p:inputTextarea value="#{newPostBackBean.item.description}">
									<p:ajax event="blur" process="@this" update="@this"/>
								</p:inputTextarea>
							</h:panelGrid>
						</p:panel>
					</p:tab>
					<p:tab id="images" title="#{msg['images']}">
						<p:fileUpload fileUploadListener="#{newPostBackBean.handleFileUpload}" mode="advanced" dragDropSupport="true"
	                          update="messages" sizeLimit="100000" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" auto="true" multiple="true" />
	 					
	    				<p:growl id="messages" showDetail="true" />
					</p:tab>
					<p:tab id="chooseImage" title="#{msg['chooseImage']}">
						
						<p:dataGrid  var="image" value="#{newPostBackBean.item.mediaList}" columns="3" layout="grid" 
							rendered="#{not newPostBackBean.choosedImage}">
								<f:facet name="header">
						            #{msg['chooseFrontImg']}
						        </f:facet>
						        
						        <p:panel header="#{image.name}" style="text-align:center">
						            <h:panelGrid columns="1" style="width:100%">
						                <p:commandLink update="chooseImage" title="#{msg['chooseImage']}">
						                    <f:setPropertyActionListener value="#{image}" target="#{newPostBackBean.choosenImage}" />
						                </p:commandLink>
						            </h:panelGrid>
						        </p:panel>
						</p:dataGrid>
						
						<h:panelGrid columns="2" rendered="#{newPostBackBean.choosedImage}">
					        <p:imageCropper minSize="100,100" maxSize="450,450" aspectRatio="1" value="#{newPostBackBean.croppedImage}" 
					        				image="#{newPostBackBean.choosenImage.url}" initialCoords="0,0,250,250"/>
					        				
					        <h:panelGroup id="cropped">
					            <p:graphicImage rendered="#{not empty newPostBackBean.item.choosenImage.url}" name="#{newPostBackBean.item.choosenImage.url}" />
					        </h:panelGroup>
					    </h:panelGrid>
					 
					    <p:commandButton value="Crop" action="#{newPostBackBean.crop}" update="cropped msgs" icon="ui-icon-scissors"/>
					    
					    
					</p:tab>
					<p:tab id="videos" title="#{msg['videos']}">
					
					</p:tab>
				</p:wizard>
			</h:form>
		</div>
	</h:body>
</html>